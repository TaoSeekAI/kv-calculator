/**
 * Kv计算系统数值常数
 * 基于 IEC 60534-2-1 标准
 */

export const CONSTANTS = {
  // ===== Kv计算常数 =====
  // 这些值来自Excel文件中的实际使用值

  /**
   * N1: 液体Kv计算常数
   * 用于: C = Q/N1 * sqrt(ρ/ρ0 / ΔP)
   * 单位: m³/h, KPa
   */
  N1: 0.1,

  /**
   * N2: 管道几何系数计算常数
   * 用于: FP计算
   */
  N2: 0.0016,

  /**
   * N4: 雷诺数计算常数
   * 用于: Rev计算
   */
  N4: 0.0707,

  /**
   * N5: xTP计算常数
   */
  N5: 0.0018,

  /**
   * N6: 蒸汽Kv计算常数
   * 用于: C = W/(N6*Y*sqrt(x*P1*ρ1))
   */
  N6: 3.16,

  /**
   * N9: 气体Kv计算常数
   * 用于: C = Qn/(N9*P1*Y) * sqrt(22.4*M*Z*T1/x)
   */
  N9: 24.6,

  /**
   * N14: 噪音计算常数
   */
  N14: 0.0049,

  /**
   * N16: 噪音计算常数
   */
  N16: 42300,

  /**
   * N18: Fd计算常数
   */
  N18: 17.3,

  // ===== 安托因方程常数 (水) =====
  // log10(Pv) = A - B/(C + T)
  // Pv: 饱和蒸汽压 (KPa)
  // T: 温度 (℃)
  ANTOINE: {
    A: 7.07406,
    B: 1657.46,
    C: 227.02
  },

  // ===== 参考值 =====
  /** 水的标准密度 kg/m³ */
  WATER_DENSITY: 1000,

  /** 标准大气压 KPa */
  STD_PRESSURE: 101.325,

  /** 绝对零度偏移 K */
  STD_TEMP: 273.15,

  /** 水的临界压力 MPa */
  WATER_CRITICAL_PRESSURE: 22.12,

  /** Kv转Cv系数 */
  KV_TO_CV: 1.156,

  // ===== 默认值 =====
  DEFAULT: {
    /** 默认压缩系数 */
    Z: 1,
    /** 默认比热比(空气) */
    GAMMA: 1.4,
    /** 默认可调比 */
    RANGEABILITY: 50,
    /** 默认粘度 cP */
    VISCOSITY: 1,
    /** 默认Fd值 */
    FD: 0.42
  },

  // ===== 判定阈值 =====
  THRESHOLD: {
    /** 紊流判定阈值 */
    TURBULENT_RE: 10000,
    /** 误差容限 (0.1%) */
    TOLERANCE: 0.001
  }
};

/**
 * 管道规格表 - SCH40 标准壁厚
 * 格式: { DN: [外径mm, 壁厚mm] }
 */
export const PIPE_SPECS: Record<number, [number, number]> = {
  6: [10.3, 1.73],
  8: [13.7, 2.24],
  10: [17.2, 2.31],
  15: [21.3, 2.77],
  20: [26.9, 2.87],
  25: [33.7, 3.38],
  32: [42.4, 3.56],
  40: [48.3, 3.68],
  50: [60.3, 3.91],
  65: [76.1, 5.16],
  80: [88.9, 5.49],
  100: [114.3, 6.02],
  125: [139.7, 6.55],
  150: [168.3, 7.11],
  200: [219.1, 8.18],
  250: [273, 9.27],
  300: [323.9, 10.31],
  350: [355.6, 11.13],
  400: [406.4, 12.27],
  450: [457, 14.27],
  500: [508, 15.09],
  600: [610, 17.45]
};

/**
 * 根据DN获取管道规格
 */
export function getPipeSpec(dn: number): { outerDiameter: number; wallThickness: number } | null {
  const spec = PIPE_SPECS[dn];
  if (!spec) return null;
  return {
    outerDiameter: spec[0],
    wallThickness: spec[1]
  };
}
